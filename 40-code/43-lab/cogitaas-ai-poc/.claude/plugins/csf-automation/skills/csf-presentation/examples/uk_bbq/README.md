# UK BBQ Example

This example demonstrates the two-stage interpretation workflow for CSF Stage 7a using UK BBQ sauce category data.

## Two-Output Workflow

Stage 7a interpretation follows a deterministic-then-judgment pattern:

1. **Output 1** (`output-1.yaml`): Script-generated with deterministic fields
2. **Output 2** (`output-2.yaml`): Claude-enhanced with strategic assessments

### What the Script Generates (Output 1)

**Deterministic fields** (fully automated by `interpret_results.py`):
- Metric extraction (CSF, PE, MCV, MSP, market share, revenue, volume)
- Categorizations (high/medium/low CSF, elastic/moderately/highly elastic PE, etc.)
- Competitive comparisons (CSF differences vs each competitor)
- Market position determination (leader vs follower)
- Standard interpretation text from templates
- Placeholder: `[Claude: Provide strategic assessment for {brand}]` for overall_assessment

### What Claude Enhances (Output 2)

**Non-deterministic field** (requires business judgment):
- **interpretation.overall_assessment** - Strategic synthesis combining:
  - CSF + PE + MSP insights
  - Market position context
  - Competitive dynamics
  - Specific pricing recommendations
  - Business-relevant insights

All fields from Output 1 are carried forward to Output 2, with only `overall_assessment` enhanced.

## Input Data

**File**: `input.csv`
**Source**: UK BBQ CSF analysis Stage 6 output
**Level of Analysis**: Brand level (all variants and PPGs aggregated)

### Data Overview

- **Market**: UK
- **Category**: BBQ Sauce
- **Channels**: 4 (iceland gb, supermarket, tesco gb, the cooperative group gb)
- **Total Brand-Channel Combinations**: 26
- **Brands analyzed**: heinz, hp, bulls eye, private label, restofcategory, sides, crucials, hellmanns, nandos, levi roots, sweet baby rays, reds

## Output 1: Script-Generated (output-1.yaml)

Generated by running:
```bash
nix shell nixpkgs#stdenv.cc.cc.lib nixpkgs#zlib --command bash -c "
  export LD_LIBRARY_PATH=...:... &&
  ../../scripts/interpret_results.py input.csv output-1.yaml \
    --project-name 'UK BBQ' --market 'uk' --categories 'bbq sauce'
"
```

### Key Script Outputs

**Categorizations applied** (26 brand-channel combinations):
- CSF categories: 22 high, 4 medium, 0 low
- PE categories: 10 less elastic, 15 moderately elastic, 1 highly elastic
- MSP categories: 10 positive, 4 stable, 12 negative

**Competitive comparisons generated**: 69 brand-vs-competitor pairs

**Placeholders for Claude**: 26 `overall_assessment` fields marked `[Claude: Provide ...]`

## Output 2: Claude-Enhanced (output-2.yaml)

Claude reviews Output 1 and enhances all `overall_assessment` fields with strategic insights.

### Example Enhancements

**Heinz in Iceland GB** (Market Leader):
- **Script output**: `[Claude: Provide strategic assessment for heinz]`
- **Claude enhancement**: "Dominant market leader (51% share) with strong pricing power in Iceland. High CSF (2.32) combined with less elastic demand (-3.79) and positive momentum (MSP +0.0015) creates excellent pricing opportunity. Can consider 5-7% price increase with minimal volume risk."

**Bulls Eye in Supermarket** (Struggling Brand):
- **Script output**: `[Claude: Provide strategic assessment for bulls eye]`
- **Claude enhancement**: "Vulnerable position with lowest CSF (1.68) in channel and highly elastic demand (-7.30). Losing share (MSP -0.0025) despite already weak position. Avoid price increases - needs marketing investment or repositioning to improve value perception before any pricing action."

**Nandos in Iceland GB** (Premium Brand):
- **Script output**: `[Claude: Provide strategic assessment for nandos]`
- **Claude enhancement**: "Premium brand with highest CSF (2.49) in channel and gaining share (+0.005 MSP). Exceptional pricing power with very low elasticity (-3.35). Successfully operating at premium price point (£7.54 vs category average ~£5). Continue premium positioning and consider moderate price increase (3-5%)."

### Claude's Enhancement Process

For each brand, Claude synthesizes:

1. **Metric combination pattern**: CSF + PE + MSP category interaction
2. **Market position context**: Leader vs follower dynamics
3. **Competitive standing**: CSF relative to specific competitors
4. **Strategic archetype**: Premium, growth, vulnerable, mature, etc.
5. **Specific recommendation**: Price increase %, hold, or avoid with rationale

## How the Script Generated Output 1

1. **Parsed CSV**: Extracted all 26 brand-channel combinations
2. **Inferred Level**: Detected `brand_level` from Variant="all" and PPG="all"
3. **Applied CSF Rules**:
   - High: CSF ≥ 2.0 (22 brands)
   - Medium: 1.7 ≤ CSF < 2.0 (4 brands)
   - Low: CSF < 1.7 (0 brands)
4. **Applied PE Rules**:
   - Less elastic: PE ≥ -4.0 (10 brands)
   - Moderately elastic: -8.0 < PE < -4.0 (15 brands)
   - Highly elastic: PE ≤ -8.0 (1 brand)
5. **Applied MSP Rules**:
   - Positive: MSP > 0.001 (10 brands)
   - Stable: -0.001 ≤ MSP ≤ 0.001 (4 brands)
   - Negative: MSP < -0.001 (12 brands)
6. **Identified Competitors**: For each brand, found all other brands in same channel
7. **Calculated CSF Differences**: Brand CSF minus each competitor's CSF
8. **Determined Market Position**: Leader (highest share) vs Follower for each channel
9. **Generated Standard Text**: Applied interpretation templates for CSF/PE/MSP insights
10. **Added Placeholders**: Inserted `[Claude: Provide ...]` for overall_assessment fields

## Channel Highlights

### Iceland GB
- Heinz dominates with 51.1% share
- All brands show high CSF (2.13-2.49), indicating strong category loyalty
- Nandos has highest CSF (2.49) despite smaller share - premium positioning
- Several smaller brands losing share (crucials, sides)

### Supermarket
- Heinz leads with 31.7% share but lower CSF (1.80) than Iceland
- Higher price elasticity across brands (-6 to -7 range)
- Bulls Eye weakest with CSF 1.68 and highly elastic demand (-7.30)
- More competitive channel with tighter CSF spread

### Tesco GB
- Heinz leads (34.5%) with similar dynamics to Supermarket
- HP shows better CSF (2.00) than in Supermarket (1.72) - channel-specific strength
- Bulls Eye continues to struggle (CSF 1.63, PE -7.93)

### The Cooperative Group GB
- Heinz leads (33.0%) with stronger CSF (2.07) than other national chains
- Sweet Baby Rays has strong CSF (2.13) despite smaller share
- Reds brand losing significant share (MSP -0.0077)

## Usage

To regenerate this example:

```bash
# From the skill directory
cd .plugins/csf/skills/interpret-results/examples/uk_bbq

# Run script to generate Output 1 (with nix shell for pandas support)
nix shell nixpkgs#stdenv.cc.cc.lib nixpkgs#zlib --command bash -c "
  export LD_LIBRARY_PATH=\$(nix eval --raw nixpkgs#stdenv.cc.cc.lib)/lib:\$(nix eval --raw nixpkgs#zlib)/lib:\$LD_LIBRARY_PATH &&
  ../../scripts/interpret_results.py input.csv output-1.yaml \
    --project-name 'UK BBQ' --market 'uk' --categories 'bbq sauce'
"

# Then Claude reviews output-1.yaml and creates output-2.yaml with enhancements
# See output-2.yaml for example of enhanced assessments with non-deterministic fields marked
```

## Next Steps

1. Review `output-1.yaml` to understand script-generated structure
2. Review `output-2.yaml` to see enhanced strategic assessments
3. Use this pattern for other CSF projects (generate Output 1, enhance to Output 2)
4. Use Output 2 as input to Stage 7b (presentation planning)
5. Validate findings with business stakeholders
